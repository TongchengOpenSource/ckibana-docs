"use strict";(self.webpackChunkdocusaurus_docs=self.webpackChunkdocusaurus_docs||[]).push([[578],{3905:function(t,e,n){n.d(e,{Zo:function(){return d},kt:function(){return m}});var a=n(7294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},l=Object.keys(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var p=a.createContext({}),u=function(t){var e=a.useContext(p),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},d=function(t){var e=u(t.components);return a.createElement(p.Provider,{value:e},t.children)},s={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},c=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,l=t.originalType,p=t.parentName,d=o(t,["components","mdxType","originalType","parentName"]),c=u(n),m=r,k=c["".concat(p,".").concat(m)]||c[m]||s[m]||l;return n?a.createElement(k,i(i({ref:e},d),{},{components:n})):a.createElement(k,i({ref:e},d))}));function m(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var l=n.length,i=new Array(l);i[0]=c;var o={};for(var p in e)hasOwnProperty.call(e,p)&&(o[p]=e[p]);o.originalType=t,o.mdxType="string"==typeof t?t:r,i[1]=o;for(var u=2;u<l;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},7703:function(t,e,n){n.r(e),n.d(e,{contentTitle:function(){return p},default:function(){return c},frontMatter:function(){return o},metadata:function(){return u},toc:function(){return d}});var a=n(7462),r=n(3366),l=(n(7294),n(3905)),i=["components"],o={sidebar_position:3},p="api-docs",u={unversionedId:"api-docs",id:"api-docs",title:"api-docs",description:"application\u6587\u4ef6",source:"@site/docs/en/api-docs.md",sourceDirName:".",slug:"/api-docs",permalink:"/en/api-docs",editUrl:"https://git.17usoft.com/tech_inf/es2ck-kibana-proxy-doc/tree/master/docs/en/api-docs.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"usercase",permalink:"/en/UserCase"},next:{title:"troubleshooting",permalink:"/en/troubleshooting"}},d=[{value:"application\u6587\u4ef6",id:"application\u6587\u4ef6",children:[],level:2},{value:"\u5efa\u8868\u8be6\u89e3",id:"\u5efa\u8868\u8be6\u89e3",children:[{value:"\u5efa\u8868\u8bf4\u660e",id:"\u5efa\u8868\u8bf4\u660e",children:[],level:3},{value:"es\u7684\u7c7b\u578b \u8ddf ck\u7684\u7c7b\u578b\u7684mapping",id:"es\u7684\u7c7b\u578b-\u8ddf-ck\u7684\u7c7b\u578b\u7684mapping",children:[],level:3}],level:2},{value:"\u76f8\u5173\u7cfb\u7edf\u7d22\u5f15",id:"\u76f8\u5173\u7cfb\u7edf\u7d22\u5f15",children:[{value:"proxy-settings",id:"proxy-settings",children:[{value:"\u53c2\u6570\u8be6\u89e3",id:"\u53c2\u6570\u8be6\u89e3",children:[],level:4}],level:3},{value:"proxy-monitor",id:"proxy-monitor",children:[],level:3},{value:"proxy-black-list",id:"proxy-black-list",children:[{value:"\u83b7\u53d6",id:"\u83b7\u53d6",children:[],level:4},{value:"\u65b0\u589e",id:"\u65b0\u589e",children:[],level:4},{value:"\u5220\u9664",id:"\u5220\u9664",children:[],level:4}],level:3}],level:2}],s={toc:d};function c(t){var e=t.components,n=(0,r.Z)(t,i);return(0,l.kt)("wrapper",(0,a.Z)({},s,n,{components:e,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"api-docs"},"api-docs"),(0,l.kt)("h2",{id:"application\u6587\u4ef6"},"application\u6587\u4ef6"),(0,l.kt)("p",null,"\u8be5\u6587\u4ef6\u662f\u4e00\u4e9b\u57fa\u672c\u914d\u7f6e\uff0c\u7aef\u53e3\u3001\u65e5\u5fd7\u7b49\uff0c\u6838\u5fc3\u7684\u5c31\u662fmetadata-config\u53c2\u6570\u4e86\u3002"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570\u540d"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"metadata-config"),(0,l.kt)("td",{parentName:"tr",align:null},"object"),(0,l.kt)("td",{parentName:"tr",align:null},"ES\u5143\u6570\u636e\u96c6\u7fa4")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"hosts"),(0,l.kt)("td",{parentName:"tr",align:null},"String"),(0,l.kt)("td",{parentName:"tr",align:null},"ES\u5143\u6570\u636e\u96c6\u7fa4host")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"headers"),(0,l.kt)("td",{parentName:"tr",align:null},"String"),(0,l.kt)("td",{parentName:"tr",align:null},"ES\u5143\u6570\u636e\u96c6\u7fa4user\u3001pass\u6821\u9a8c\u4fe1\u606f")))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"\u4f8b\u5b50\uff1a\nmetadata-config:\n  hosts: your es metadata cluster hosts\n  headers:\n    Authorization: 'username password'\n")),(0,l.kt)("h2",{id:"\u5efa\u8868\u8be6\u89e3"},"\u5efa\u8868\u8be6\u89e3"),(0,l.kt)("h3",{id:"\u5efa\u8868\u8bf4\u660e"},"\u5efa\u8868\u8bf4\u660e"),(0,l.kt)("p",null,"\u5efa\u8868\u8bed\u53e5\u4e2d\u7684\u5b57\u6bb5\uff0c\u65f6\u95f4\u5b57\u6bb5\u662f\u5fc5\u9700\uff0c\u5982\u8868\u4e2d\u7684@timestamp\u5b57\u6bb5\uff0c\u4f5c\u4e3a\u5728kibana\u521b\u5efaindex pattern\u65f6\u7684\u65f6\u95f4\u9009\u9879\uff0c\u5176\u5b83\u5b57\u6bb5\u6839\u636e\u672c\u8eab\u4e1a\u52a1\u67e5\u8be2\u6761\u4ef6\u6309\u9700\u6dfb\u52a0\u3002"),(0,l.kt)("p",null,"\u4e0b\u9762\u662f\u4e00\u4e2a\u5efa\u8868\u8bed\u53e5\u7684\u4f8b\u5b50"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"create database ckibana;\nuse ckibana;\n\nCREATE TABLE ckibana.table_local\n(\n    `request_method` LowCardinality(String),\n    `request_time` Float64,\n    `http_host` String,\n    `@timestamp` UInt64,\n    `ck_assembly_extension` String,\n    INDEX timestamp_index `@timestamp` TYPE minmax GRANULARITY 8192\n)\nENGINE = MergeTree\nPARTITION BY (toYYYYMMDD(toDateTime(`@timestamp` / 1000, 'Asia/Shanghai')), toHour(toDateTime(`@timestamp` / 1000, 'Asia/Shanghai')))\nORDER BY (`http_host`)\nSETTINGS in_memory_parts_enable_wal = 0, index_granularity = 8192;\n\nCREATE TABLE IF NOT EXISTS ckibana.table_all AS ckibana.table_local ENGINE Distributed('clickhouse_cluster', ckibana, table_local, rand());\n")),(0,l.kt)("p",null,"\u5f53\u8981\u4f7f\u7528\u91c7\u6837\u529f\u80fd\u65f6\uff0c\u9700\u8981\u5728\u5efa\u8868\u8bed\u53e5\u4e2d\u4fee\u6539",(0,l.kt)("inlineCode",{parentName:"p"},"ORDER BY\u3001SAMPLE BY"),"\u8bed\u53e5\uff0c\u66f4\u8be6\u7ec6\u53ef\u4ee5\u53c2\u8003",(0,l.kt)("a",{parentName:"p",href:"https://clickhouse.com/docs/en/sql-reference/statements/select/sample"},"clickhouse\u5b98\u65b9\u8bf4\u660e")," \u3002"),(0,l.kt)("p",null,"\u8bf4\u660e\uff1a\u91c7\u6837\u5b57\u6bb5\u53ef\u4ee5\u662f\u81ea\u5df1\u5b9a\u4e49\u7684\u5b57\u6bb5\uff0c\u4f46\u662f\u5b57\u6bb5\u5fc5\u987b\u8bbe\u7f6e\u4e3aUInt64\u7c7b\u578b\uff0c\u63a8\u8350\u8fd8\u662f\u4f7f\u7528@timestamp\u5b57\u6bb5\u4f5c\u4e3a\u91c7\u6837\u5b57\u6bb5\uff0c\u4e0d\u7528\u989d\u5916\u521b\u5efa\u5b57\u6bb5"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"create database ckibana;\nuse ckibana;\n\nCREATE TABLE ckibana.table_local\n(\n    `request_method` LowCardinality(String),\n    `request_time` Float64,\n    `http_host` String,\n    `@timestamp` UInt64,\n    `ck_assembly_extension` String,\n    INDEX timestamp_index `@timestamp` TYPE minmax GRANULARITY 8192\n)\nENGINE = MergeTree\nPARTITION BY (toYYYYMMDD(toDateTime(`@timestamp` / 1000, 'Asia/Shanghai')), toHour(toDateTime(`@timestamp` / 1000, 'Asia/Shanghai')))\nORDER BY (`http_host`, intHash64(`@timestamp`))\nSAMPLE BY intHash64(`@timestamp`)\nSETTINGS in_memory_parts_enable_wal = 0, index_granularity = 8192;\n\nCREATE TABLE IF NOT EXISTS ckibana.table_all AS ckibana.table_local ENGINE Distributed('clickhouse_cluster', ckibana, table_local, rand());\n")),(0,l.kt)("h3",{id:"es\u7684\u7c7b\u578b-\u8ddf-ck\u7684\u7c7b\u578b\u7684mapping"},"es\u7684\u7c7b\u578b \u8ddf ck\u7684\u7c7b\u578b\u7684mapping"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"es\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"ck\u7c7b\u578b"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"keyword"),(0,l.kt)("td",{parentName:"tr",align:null},"String")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"text"),(0,l.kt)("td",{parentName:"tr",align:null},"String")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"ip"),(0,l.kt)("td",{parentName:"tr",align:null},"String(\u4ee3\u7406\u81ea\u52a8\u8bc6\u522bipv4\u548cipv6)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"integer"),(0,l.kt)("td",{parentName:"tr",align:null},"Int32")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"long"),(0,l.kt)("td",{parentName:"tr",align:null},"Int64")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float"),(0,l.kt)("td",{parentName:"tr",align:null},"Float32")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"double"),(0,l.kt)("td",{parentName:"tr",align:null},"Float64")))),(0,l.kt)("h2",{id:"\u76f8\u5173\u7cfb\u7edf\u7d22\u5f15"},"\u76f8\u5173\u7cfb\u7edf\u7d22\u5f15"),(0,l.kt)("h3",{id:"proxy-settings"},"proxy-settings"),(0,l.kt)("p",null,"\u9ed8\u8ba4\u8be5\u7d22\u5f15\u540d\u4e3aproxy-settings\uff0c\u5982\u60a8\u4f7f\u7528\u4e00\u4e2a\u5143\u6570\u636e\u96c6\u7fa4\u6765\u7ba1\u7406\u591a\u4e2akibana proxy\uff0c\u53ef\u4ee5\u5229\u7528application.yml\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"metadata.config.tingsSuffix"),"\u5c5e\u6027\u3002"),(0,l.kt)("h4",{id:"\u53c2\u6570\u8be6\u89e3"},"\u53c2\u6570\u8be6\u89e3"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570\u540d"),(0,l.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u662f\u5426\u5fc5\u987b"),(0,l.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"query.sampleIndexPatterns"),(0,l.kt)("td",{parentName:"tr",align:null},"Array"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9700\u8981\u5f00\u542f\u91c7\u6837\u7684\u7d22\u5f15\uff0c\u5339\u914d\u65b9\u5f0f\u6309\u7167\u524d\u7f00\u5339\u914d\uff0c\u6ce8\u610f\u5982\u679c\u9700\u8981\u4f7f\u7528\u91c7\u6837\uff0c\u5219\u5efa\u8868\u8bed\u53e5\u5fc5\u987b\u8981\u652f\u6301 SAMPLE BY")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"query.sampleCountMaxThreshold"),(0,l.kt)("td",{parentName:"tr",align:null},"Int"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5f00\u542f\u91c7\u6837\u7684\u9608\u503c\uff0c\u4e00\u4e2amsearch\u67e5\u8be2\u5230\u7684\u6570\u636e\u91cf\u8d85\u8fc7\u8fd9\u4e2a\u9608\u503c\uff0c\u624d\u4f1a\u5f00\u542f\u91c7\u6837\u3002\u8bf4\u660e\uff1a\u5f53\u6570\u636e\u91cf\u6bd4\u8f83\u5927\u65f6\uff0c\u6b64\u503c\u4e5f\u9700\u8981\u914d\u7f6e\u7a0d\u5927\uff0c\u56fe\u8868\u624d\u4f1a\u66f4\u63a5\u8fd1")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"query.useCache"),(0,l.kt)("td",{parentName:"tr",align:null},"Boolean"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9ed8\u8ba4\u5173\u95ed\uff0c\u662f\u5426\u542f\u7528\u7f13\u5b58\uff0c\u5c06\u67e5\u8be2\u7ed3\u679c\u7f13\u5b58\u8fdbES")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"proxy.roundAbleMinPeriod"),(0,l.kt)("td",{parentName:"tr",align:null},"Long"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8d85\u8fc7ROUND_ABLE_MIN_PERIOD \u652f\u6301round.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"proxy.maxTimeRange"),(0,l.kt)("td",{parentName:"tr",align:null},"Long"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8fc7\u957f\u65f6\u95f4\u5468\u671f\uff0c\u9ed8\u8ba41\u5929.")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"proxy.blackIndexList"),(0,l.kt)("td",{parentName:"tr",align:null},"Array"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9ed1\u540d\u5355\u5217\u8868\uff0c\u6309\u7167\u524d\u7f00\u5339\u914d\uff0c\u914d\u7f6e\u7684\u7d22\u5f15\u4e0d\u4f1a\u8d70ck\u67e5\u8be2\uff0c\u800c\u662f\u76f4\u63a5\u67e5\u8be2es")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"proxy.whiteIndexList"),(0,l.kt)("td",{parentName:"tr",align:null},"Array"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"\u767d\u540d\u5355\u5217\u8868\uff0c\u6309\u7167\u524d\u7f00\u5339\u914d\uff0c\u914d\u7f6e\u7684\u7d22\u5f15\u4f1a\u901a\u8fc7ck\u53bb\u67e5\u8be2")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"proxy.es"),(0,l.kt)("td",{parentName:"tr",align:null},"Object"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8be5\u4e1a\u52a1\u96c6\u7fa4\u7ec4es\u96c6\u7fa4\u914d\u7f6e\uff0c\u4e0d\u914d\u7f6e\u7684\u8bdd\u9ed8\u8ba4\u8d70\u4f7f\u7528metadata-config\u914d\u7f6e\u7684ES")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"proxy.ck"),(0,l.kt)("td",{parentName:"tr",align:null},"Object"),(0,l.kt)("td",{parentName:"tr",align:null},"\u662f"),(0,l.kt)("td",{parentName:"tr",align:null},"\u8be5\u4e1a\u52a1\u96c6\u7fa4\u7ec4ck\u96c6\u7fa4\u914d\u7f6e")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"proxy.enableMonitoring"),(0,l.kt)("td",{parentName:"tr",align:null},"Boolean"),(0,l.kt)("td",{parentName:"tr",align:null},"\u5426"),(0,l.kt)("td",{parentName:"tr",align:null},"\u9ed8\u8ba4\u5173\u95ed\uff0c\u662f\u5426\u5f00\u542f\u67e5\u8be2sql\u76d1\u63a7")))),(0,l.kt)("p",null,"\u66f4\u65b0ES\u5143\u6570\u636e\u96c6\u7fa4\u914d\u7f6e\uff0cckibana\u63d0\u4f9b\u5982\u4e0b\u63a5\u53e3"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"1\uff09\u66f4\u65b0CK\u914d\u7f6e")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location --request POST 'localhost:8080/config/updateCk?url=ckUrl&user=default&pass=default&defaultCkDatabase=ops'\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"2\uff09\u66f4\u65b0ES\u914d\u7f6e")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location --request POST 'localhost:8080/config/updateEs?host=esHost&headers=key:value,key2:value2'\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"3\uff09\u66f4\u65b0\u767d\u540d\u5355\u7d22\u5f15")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location --request POST 'localhost:8080/config/updateWhiteIndexList?list=index1,index2'\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"4\uff09\u66f4\u65b0\u9ed1\u540d\u5355\u7d22\u5f15")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location --request POST 'localhost:8080/config/updateBlackIndexList?list=index1,index2'\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"5\uff09\u66f4\u65b0\u91c7\u6837\u7d22\u5f15")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location --request POST 'localhost:8080/config/updateSampleIndexList?list=index1,index2'\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"6\uff09\u66f4\u65b0sampleCountMaxThreshold")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location --request POST 'localhost:8080/config/updateSampleCountMaxThreshold?sampleCountMaxThreshold=1500000'\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"7\uff09\u66f4\u65b0useCache")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location --request POST 'localhost:8080/config/updateUseCache?useCache=true'\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"8\uff09\u66f4\u65b0roundAbleMinPeriod")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location --request POST 'localhost:8080/config/updateRoundAbleMinPeriod?roundAbleMinPeriod=1200000'\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"9\uff09\u66f4\u65b0maxTimeRange")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location --request POST 'localhost:8080/config/updateMaxTimeRange?maxTimeRange=864000000'\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"10\uff09\u66f4\u65b0enableMonitoring")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location --request POST 'localhost:8080/config/updateEnableMonitoring?enableMonitoring=false'\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"11\uff09\u66f4\u65b0msearchThreadPoolCoreSize")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location --request POST 'localhost:8080/config/updateMsearchThreadPoolCoreSize?msearchThreadPoolCoreSize=4'\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"12\uff09\u83b7\u53d6\u914d\u7f6e\u63a5\u53e3")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location 'localhost:8080/config/all'\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"13\uff09\u5168\u91cf\u66f4\u65b0\u914d\u7f6e\u63a5\u53e3")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'curl --location \'localhost:8080/config/all\' \\\n--header \'Content-Type: application/json\' \\\n--data \'{\n    "query":{\n        "sampleIndexPatterns":[\n            "index1",\n            "index2"\n        ],\n        "sampleCountMaxThreshold":"1500000",\n        "useCache":false\n    },\n    "proxy":{\n        "roundAbleMinPeriod":120000,\n        "maxTimeRange":86400000,\n        "enableMonitoring":true,\n        "blackIndexList":[\n            "index1",\n            "index2"\n        ],\n        "whiteIndexList":[\n            "index1",\n            "index2"\n        ],\n        "es":{\n            "host":"esHost\n            "headers":[\n                {\n                    "Authorization":"yourEsClusterAuthorization"\n                }\n            ]\n        },\n        "ck":{\n            "url":"ckUrl",\n            "user":"default",\n            "pass":"default",\n            "defaultCkDatabase":"ops"\n        }\n    }\n}\'\n')),(0,l.kt)("h3",{id:"proxy-monitor"},"proxy-monitor"),(0,l.kt)("p",null,"\u63d0\u4f9b\u76d1\u63a7\u7d22\u5f15\u3002\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6253\u5f00\u3002"),(0,l.kt)("p",null,"\u53ef\u5229\u7528\u8be5\u7d22\u5f15\u8fdb\u884ckibana\u4e0a\u7684sql\u76d1\u63a7\u3002"),(0,l.kt)("h3",{id:"proxy-black-list"},"proxy-black-list"),(0,l.kt)("p",null,"\u7d22\u5f15\u67e5\u8be2sql\u9ed1\u540d\u5355\u3002\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6253\u5f00\u3002"),(0,l.kt)("p",null,"\u8be5\u7d22\u5f15\u53ef\u4ee5\u901a\u8fc7kibana proxy\u76f4\u63a5\u64cd\u4f5c\uff1a"),(0,l.kt)("h4",{id:"\u83b7\u53d6"},"\u83b7\u53d6"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location 'http://localhost:8080/proxy/_black_list'\n")),(0,l.kt)("h4",{id:"\u65b0\u589e"},"\u65b0\u589e"),(0,l.kt)("p",null,"range: \u67e5\u8be2\u95f4\u9694\uff08\u6beb\u79d2\uff09"),(0,l.kt)("p",null,"sql: \u53bb\u9664\u65f6\u95f4\u8303\u56f4\u7684\u6761\u4ef6\u67e5\u8be2\u8bed\u53e5\uff0c\u53ef\u5728monitor\u65e5\u5fd7\u4e2d\u83b7\u53d6\u5230"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'curl --location \'http://localhost:8080/proxy/_black_list\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{\n    "range": "900000",\n    "sql": "((`@timestamp` = 1698293120000))"\n}\'\n')),(0,l.kt)("h4",{id:"\u5220\u9664"},"\u5220\u9664"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"curl --location --request DELETE 'http://localhost:8080/proxy/_black_list/{id}'\n")))}c.isMDXComponent=!0}}]);
"use strict";(self.webpackChunkdocusaurus_docs=self.webpackChunkdocusaurus_docs||[]).push([[230],{5680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>h});var i=n(6540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},g=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),g=a,h=d["".concat(l,".").concat(g)]||d[g]||u[g]||r;return n?i.createElement(h,o(o({ref:t},p),{},{components:n})):i.createElement(h,o({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=g;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:a,o[1]=s;for(var c=2;c<r;c++)o[c]=n[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}g.displayName="MDXCreateElement"},8649:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var i=n(8168),a=(n(6540),n(5680));n(1873);const r={sidebar_position:4},o="troubleshooting",s={unversionedId:"troubleshooting",id:"troubleshooting",title:"troubleshooting",description:"1\u3001Cannot open Kibana.",source:"@site/docs/en/troubleshooting.md",sourceDirName:".",slug:"/troubleshooting",permalink:"/ckibana-docs/en/troubleshooting",editUrl:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"api-docs",permalink:"/ckibana-docs/en/api-docs"},next:{title:"Introduce",permalink:"/ckibana-docs/en/"}},l=[{value:"1\u3001Cannot open Kibana.",id:"1cannot-open-kibana",children:[],level:2},{value:"2\u3001Unable to create an <code>index pattern</code>",id:"2unable-to-create-an-index-pattern",children:[{value:"The troubleshooting steps are as follows:",id:"the-troubleshooting-steps-are-as-follows",children:[],level:3}],level:2},{value:"3\u3001When creating an index pattern, the time field cannot be selected.",id:"3when-creating-an-index-pattern-the-time-field-cannot-be-selected",children:[],level:2},{value:"4\u3001Unable to retrieve data.",id:"4unable-to-retrieve-data",children:[],level:2},{value:"5\u3001High CPU usage in ClickHouse",id:"5high-cpu-usage-in-clickhouse",children:[],level:2},{value:"6\u3001User Privilege Error",id:"6user-privilege-error",children:[],level:2}],c={toc:l},p="wrapper";function d(e){let{components:t,...r}=e;return(0,a.yg)(p,(0,i.A)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"troubleshooting"},"troubleshooting"),(0,a.yg)("h2",{id:"1cannot-open-kibana"},"1\u3001Cannot open Kibana."),(0,a.yg)("p",null,(0,a.yg)("img",{src:n(1295).A})),(0,a.yg)("p",null,"The high probability of this error is that the initialization configuration is not correct."),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"1\uff09Check if the metadata cluster in the configuration is correct")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"2\uff09Check the ",(0,a.yg)("inlineCode",{parentName:"strong"},"elasticsearchHosts")," parameter in Kibana's configuration to see if the proxy address is correct and accessible. The following information should appear to indicate that the proxy configuration is correct")),(0,a.yg)("p",null,(0,a.yg)("img",{src:n(2278).A})),(0,a.yg)("h2",{id:"2unable-to-create-an-index-pattern"},"2\u3001Unable to create an ",(0,a.yg)("inlineCode",{parentName:"h2"},"index pattern")),(0,a.yg)("p",null,"As shown in the figure, the red box is when creating the index pattern. If the corresponding index pattern cannot be created."),(0,a.yg)("p",null,(0,a.yg)("img",{src:n(2388).A})),(0,a.yg)("h3",{id:"the-troubleshooting-steps-are-as-follows"},"The troubleshooting steps are as follows:"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"1\uff09First determine whether a whitelist has been added to the table name, please refer to:",(0,a.yg)("a",{parentName:"strong",href:"https://github.com/TongchengOpenSource/ckibana-docs/blob/main/api-docs.md"},"api-docs")," Update the whitelist index interface")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"2\uff09Determine whether the index pattern to be created is consistent with the ck table. The index pattern and the ck table name are an exact match")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"3\uff09Check whether the configuration of the ClickHouse database is normal.")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"4\uff09Using the SQL output from the logs, check whether the corresponding table can be queried in ClickHouse")),(0,a.yg)("p",null,"After opening this interface, the output of the sql can be seen in CKibana's log, paste it into clickhouse and execute to view it."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre"},"[query][87ms] sql=SELECT name FROM system.tables WHERE database = 'ops'\n")),(0,a.yg)("p",null,(0,a.yg)("img",{src:n(9160).A})),(0,a.yg)("h2",{id:"3when-creating-an-index-pattern-the-time-field-cannot-be-selected"},"3\u3001When creating an index pattern, the time field cannot be selected."),(0,a.yg)("p",null,"The logic for matching the time field is:"),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"1\uff09Fields of type Date, such as DateTime64, will be recognized as time fields.")),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},'2\uff09Alternatively, if the field name contains "time", such as (@timestamp UInt64), it will be recognized as a time field.')),(0,a.yg)("p",null,"Either of these conditions will be satisfied and the field will be recognized as a time field. If the time field cannot be selected, you need to check whether the fields in the ClickHouse table meet the matching logic."),(0,a.yg)("h2",{id:"4unable-to-retrieve-data"},"4\u3001Unable to retrieve data."),(0,a.yg)("p",null,"You can see the specific SQL query being executed by opening the F12 console and inspecting the response."),(0,a.yg)("p",null,(0,a.yg)("img",{src:n(3651).A})),(0,a.yg)("h2",{id:"5high-cpu-usage-in-clickhouse"},"5\u3001High CPU usage in ClickHouse"),(0,a.yg)("p",null,"Specific analysis can be done based on ",(0,a.yg)("inlineCode",{parentName:"p"},"system.query_log")," in ClickHouse, with a focus on the two indicators ",(0,a.yg)("inlineCode",{parentName:"p"},"read_rows")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"read_bytes")),(0,a.yg)("p",null,"The processing plan includes:"),(0,a.yg)("p",null,"**1\uff09Find the corresponding SQL query and add it to the CKibana blacklist."),(0,a.yg)("p",null,"**2\uff09Adjust the corresponding chart"),(0,a.yg)("h2",{id:"6user-privilege-error"},"6\u3001User Privilege Error"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-java"},' [{"type":"security_exception","reason":"action [indices:data/write/bulk[s]] is unauthorized for user [elastic] with effective roles [superuser] on restricted indices [.kibana_analytics_8.11.3_001], this action is granted by the index privileges [create_doc,create,delete,index,write,all]"},{"type":"security_exception","reason":"action [indices:data/write/bulk[s]] is unauthorized for user [elastic] with effective roles [superuser] on restricted indices [.kibana_analytics_8.11.3_001],\n')),(0,a.yg)("p",null,"When a similar error occurs, it means that the user lacks the following permissions, which can be solved by adding them in kibana:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"kibana_system")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"kibana_admin")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"superuser"))))}d.isMDXComponent=!0},2388:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/img01-aa99af9a331d76742dd18077e7ec3ae6.png"},1295:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/img02-866ea913c621c0783cbccec13fa22125.png"},2278:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/img03-9a602c7078790aa3b2503dbe6f810cb3.png"},3651:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/troubleshooting01-978f5c98da7d4607eb4ac57d4e4fab15.png"},9160:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/troubleshooting02-81484b9d91c93cbb1b20c97a3fad8d15.png"},1873:(e,t,n)=>{n(6540)}}]);
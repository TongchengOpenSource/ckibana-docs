<!doctype html>
<html class="docs-version-current" lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">api-docs | 𝑪𝑲𝒊𝒃𝒂𝒏𝒂</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="http://CKibana.inf.17usoft.com/docs//ckibana-docs/zh/api-docs"><meta data-react-helmet="true" name="docusaurus_locale" content="zh"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="api-docs | 𝑪𝑲𝒊𝒃𝒂𝒏𝒂"><meta data-react-helmet="true" name="description" content="application文件"><meta data-react-helmet="true" property="og:description" content="application文件"><link data-react-helmet="true" rel="shortcut icon" href="/ckibana-docs/img/logo.svg"><link data-react-helmet="true" rel="canonical" href="http://CKibana.inf.17usoft.com/docs//ckibana-docs/zh/api-docs"><link data-react-helmet="true" rel="alternate" href="http://CKibana.inf.17usoft.com/docs//ckibana-docs/zh/api-docs" hreflang="en"><link data-react-helmet="true" rel="alternate" href="http://CKibana.inf.17usoft.com/docs//ckibana-docs/zh/zh/api-docs" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="http://CKibana.inf.17usoft.com/docs//ckibana-docs/zh/api-docs" hreflang="x-default"><link rel="stylesheet" href="/ckibana-docs/assets/css/styles.c854e91c.css">
<link rel="preload" href="/ckibana-docs/assets/js/runtime~main.e0215409.js" as="script">
<link rel="preload" href="/ckibana-docs/assets/js/main.e9f90eef.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/ckibana-docs/"><div class="navbar__logo"><img src="/ckibana-docs/img/ckibana-new.svg" alt="Site Logo" class="themedImage_TMUO themedImage--light_4Vu1" height="32" width="32"><img src="/ckibana-docs/img/ckibana-new.svg" alt="Site Logo" class="themedImage_TMUO themedImage--dark_uzRr" height="32" width="32"></div><b class="navbar__title">𝑪𝑲𝒊𝒃𝒂𝒏𝒂</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_CDc6"><kbd class="searchHint_2RRg">ctrl</kbd><kbd class="searchHint_2RRg">K</kbd></div></div><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ckibana-docs/zh/UserCase">usercase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/ckibana-docs/zh/api-docs">api-docs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ckibana-docs/zh/troubleshooting">troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ckibana-docs/zh/">简介</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div style="position:relative" class="col docItemCol_MGa7"><div style="width:100%"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_psec"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>api-docs</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="application文件">application文件<a aria-hidden="true" class="hash-link" href="#application文件" title="Direct link to heading">​</a></h2><p>该文件是一些基本配置，端口、日志等，核心的就是metadata-config参数了。</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">例子：</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">metadata-config:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  hosts: your es metadata cluster hosts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  headers:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Authorization: &#x27;username password&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="建表详解">建表详解<a aria-hidden="true" class="hash-link" href="#建表详解" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="建表说明">建表说明<a aria-hidden="true" class="hash-link" href="#建表说明" title="Direct link to heading">​</a></h3><p>建表语句中的字段，时间字段是必需，如表中的@timestamp字段，作为在kibana创建index pattern时的时间选项，其它字段根据本身业务查询条件按需添加。</p><p>下面是一个建表语句的例子</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">create database ckibana;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">use ckibana;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CREATE TABLE ckibana.table_local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    `request_method` LowCardinality(String),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    `request_time` Float64,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    `http_host` String,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    `@timestamp` UInt64,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    `ck_assembly_extension` String,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    INDEX timestamp_index `@timestamp` TYPE minmax GRANULARITY 8192</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ENGINE = MergeTree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PARTITION BY (toYYYYMMDD(toDateTime(`@timestamp` / 1000, &#x27;Asia/Shanghai&#x27;)), toHour(toDateTime(`@timestamp` / 1000, &#x27;Asia/Shanghai&#x27;)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ORDER BY (`http_host`)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">SETTINGS in_memory_parts_enable_wal = 0, index_granularity = 8192;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CREATE TABLE IF NOT EXISTS ckibana.table_all AS ckibana.table_local ENGINE Distributed(&#x27;clickhouse_cluster&#x27;, ckibana, table_local, rand());</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>当要使用采样功能时，需要在建表语句中修改<code>ORDER BY、SAMPLE BY</code>语句，更详细可以参考<a href="https://clickhouse.com/docs/en/sql-reference/statements/select/sample" target="_blank" rel="noopener noreferrer">clickhouse官方说明</a> 。</p><p>说明：采样字段可以是自己定义的字段，但是字段必须设置为UInt64类型，推荐还是使用@timestamp字段作为采样字段，不用额外创建字段</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">create database ckibana;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">use ckibana;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CREATE TABLE ckibana.table_local</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    `request_method` LowCardinality(String),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    `request_time` Float64,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    `http_host` String,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    `@timestamp` UInt64,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    `ck_assembly_extension` String,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    INDEX timestamp_index `@timestamp` TYPE minmax GRANULARITY 8192</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ENGINE = MergeTree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PARTITION BY (toYYYYMMDD(toDateTime(`@timestamp` / 1000, &#x27;Asia/Shanghai&#x27;)), toHour(toDateTime(`@timestamp` / 1000, &#x27;Asia/Shanghai&#x27;)))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ORDER BY (`http_host`, intHash64(`@timestamp`))</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">SAMPLE BY intHash64(`@timestamp`)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">SETTINGS in_memory_parts_enable_wal = 0, index_granularity = 8192;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">CREATE TABLE IF NOT EXISTS ckibana.table_all AS ckibana.table_local ENGINE Distributed(&#x27;clickhouse_cluster&#x27;, ckibana, table_local, rand());</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="es的类型-跟-ck的类型的mapping">es的类型 跟 ck的类型的mapping<a aria-hidden="true" class="hash-link" href="#es的类型-跟-ck的类型的mapping" title="Direct link to heading">​</a></h3><h2 class="anchor anchorWithStickyNavbar_y2LR" id="相关系统索引">相关系统索引<a aria-hidden="true" class="hash-link" href="#相关系统索引" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="proxy-settings">proxy-settings<a aria-hidden="true" class="hash-link" href="#proxy-settings" title="Direct link to heading">​</a></h3><p>默认该索引名为proxy-settings，如您使用一个元数据集群来管理多个kibana proxy，可以利用application.yml的<code>metadata.config.tingsSuffix</code>属性。</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="参数详解">参数详解<a aria-hidden="true" class="hash-link" href="#参数详解" title="Direct link to heading">​</a></h4><p>更新ES元数据集群配置，ckibana提供如下接口</p><p><strong>1）更新CK配置</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request POST &#x27;localhost:8080/config/updateCk?url=ckUrl&amp;user=default&amp;pass=default&amp;defaultCkDatabase=ops&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>2）更新ES配置</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request POST &#x27;localhost:8080/config/updateEs?host=esHost&amp;headers=key:value,key2:value2&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>3）更新白名单索引</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request POST &#x27;localhost:8080/config/updateWhiteIndexList?list=index1,index2&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>4）更新黑名单索引</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request POST &#x27;localhost:8080/config/updateBlackIndexList?list=index1,index2&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>5）更新采样索引</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request POST &#x27;localhost:8080/config/updateSampleIndexList?list=index1,index2&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>6）更新sampleCountMaxThreshold</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request POST &#x27;localhost:8080/config/updateSampleCountMaxThreshold?sampleCountMaxThreshold=1500000&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>7）更新useCache</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request POST &#x27;localhost:8080/config/updateUseCache?useCache=true&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>8）更新roundAbleMinPeriod</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request POST &#x27;localhost:8080/config/updateRoundAbleMinPeriod?roundAbleMinPeriod=1200000&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>9）更新maxTimeRange</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request POST &#x27;localhost:8080/config/updateMaxTimeRange?maxTimeRange=864000000&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>10）更新enableMonitoring</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request POST &#x27;localhost:8080/config/updateEnableMonitoring?enableMonitoring=false&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>11）更新msearchThreadPoolCoreSize</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request POST &#x27;localhost:8080/config/updateMsearchThreadPoolCoreSize?msearchThreadPoolCoreSize=4&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>12）获取配置接口</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location &#x27;localhost:8080/config/all&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>13）全量更新配置接口</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location &#x27;localhost:8080/config/all&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--header &#x27;Content-Type: application/json&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--data &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;query&quot;:{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;sampleIndexPatterns&quot;:[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;index1&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;index2&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;sampleCountMaxThreshold&quot;:&quot;1500000&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;useCache&quot;:false</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;proxy&quot;:{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;roundAbleMinPeriod&quot;:120000,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;maxTimeRange&quot;:86400000,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;enableMonitoring&quot;:true,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;blackIndexList&quot;:[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;index1&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;index2&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;whiteIndexList&quot;:[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;index1&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;index2&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;es&quot;:{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;host&quot;:&quot;esHost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;headers&quot;:[</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    &quot;Authorization&quot;:&quot;yourEsClusterAuthorization&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;ck&quot;:{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;url&quot;:&quot;ckUrl&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;user&quot;:&quot;default&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;pass&quot;:&quot;default&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;defaultCkDatabase&quot;:&quot;ops&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="proxy-monitor">proxy-monitor<a aria-hidden="true" class="hash-link" href="#proxy-monitor" title="Direct link to heading">​</a></h3><p>提供监控索引。可以通过配置打开。</p><p>可利用该索引进行kibana上的sql监控。</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="proxy-black-list">proxy-black-list<a aria-hidden="true" class="hash-link" href="#proxy-black-list" title="Direct link to heading">​</a></h3><p>索引查询sql黑名单。可以通过配置打开。</p><p>该索引可以通过kibana proxy直接操作：</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="获取">获取<a aria-hidden="true" class="hash-link" href="#获取" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location &#x27;http://localhost:8080/proxy/_black_list&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="新增">新增<a aria-hidden="true" class="hash-link" href="#新增" title="Direct link to heading">​</a></h4><p>range: 查询间隔（毫秒）</p><p>sql: 去除时间范围的条件查询语句，可在monitor日志中获取到</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location &#x27;http://localhost:8080/proxy/_black_list&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--header &#x27;Content-Type: application/json&#x27; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">--data-raw &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;range&quot;: &quot;900000&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;sql&quot;: &quot;((`@timestamp` = 1698293120000))&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="删除">删除<a aria-hidden="true" class="hash-link" href="#删除" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl --location --request DELETE &#x27;http://localhost:8080/proxy/_black_list/{id}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://git.17usoft.com/tech_inf/es2ck-kibana-proxy-doc/tree/master/docs/zh/api-docs.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg style="display:inline-block;width:16px;margin:10px 5px -2px 0" width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.75 0C4.19409 0 0.5 3.675 0.5 8.20357C0.5 11.8286 2.86451 14.9 6.14241 15.9857C6.19397 15.9964 6.23817 16 6.28237 16C6.58806 16 6.70592 15.7821 6.70592 15.5929C6.70592 15.3964 6.69855 14.8821 6.69487 14.1964C6.38549 14.2643 6.10926 14.2929 5.8625 14.2929C4.27511 14.2929 3.91417 13.0964 3.91417 13.0964C3.5385 12.15 2.9971 11.8964 2.9971 11.8964C2.27891 11.4071 2.99342 11.3929 3.04866 11.3929H3.05234C3.88103 11.4643 4.31563 12.2429 4.31563 12.2429C4.72813 12.9429 5.28058 13.1393 5.77411 13.1393C6.16083 13.1393 6.51071 13.0179 6.71696 12.925C6.79063 12.3964 7.00424 12.0357 7.23996 11.8286C5.40949 11.6214 3.48326 10.9179 3.48326 7.775C3.48326 6.87857 3.80368 6.14643 4.33036 5.575C4.24565 5.36786 3.96205 4.53214 4.41138 3.40357C4.41138 3.40357 4.47031 3.38571 4.59554 3.38571C4.89386 3.38571 5.56786 3.49643 6.68013 4.24643C7.3394 4.06429 8.04286 3.975 8.74632 3.97143C9.44609 3.975 10.1532 4.06429 10.8125 4.24643C11.9248 3.49643 12.5988 3.38571 12.8971 3.38571C13.0223 3.38571 13.0813 3.40357 13.0813 3.40357C13.5306 4.53214 13.247 5.36786 13.1623 5.575C13.689 6.15 14.0094 6.88214 14.0094 7.775C14.0094 10.925 12.0795 11.6179 10.2416 11.8214C10.5363 12.075 10.8015 12.575 10.8015 13.3393C10.8015 14.4357 10.7904 15.3214 10.7904 15.5893C10.7904 15.7821 10.9046 16 11.2103 16C11.2545 16 11.306 15.9964 11.3576 15.9857C14.6392 14.9 17 11.825 17 8.20357C17 3.675 13.3059 0 8.75 0Z" fill="#92A0B3"></path></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ckibana-docs/zh/UserCase"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->usercase</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ckibana-docs/zh/troubleshooting"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">troubleshooting<!-- --> »</div></a></div></nav></div></div><div class="end"><div class="toc-wrapper" style="padding-inline-end:1rem;padding-inline-start:1rem"><h2>Contents</h2><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#application文件" class="table-of-contents__link toc-highlight">application文件</a></li><li><a href="#建表详解" class="table-of-contents__link toc-highlight">建表详解</a><ul><li><a href="#建表说明" class="table-of-contents__link toc-highlight">建表说明</a></li><li><a href="#es的类型-跟-ck的类型的mapping" class="table-of-contents__link toc-highlight">es的类型 跟 ck的类型的mapping</a></li></ul></li><li><a href="#相关系统索引" class="table-of-contents__link toc-highlight">相关系统索引</a><ul><li><a href="#proxy-settings" class="table-of-contents__link toc-highlight">proxy-settings</a></li><li><a href="#proxy-monitor" class="table-of-contents__link toc-highlight">proxy-monitor</a></li><li><a href="#proxy-black-list" class="table-of-contents__link toc-highlight">proxy-black-list</a></li></ul></li></ul></div><a href="https://git.17usoft.com/tech_inf/es2ck-kibana-proxy-doc/tree/master/docs/zh/api-docs.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg style="display:inline-block;width:16px;margin:10px 5px -2px 0" width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.75 0C4.19409 0 0.5 3.675 0.5 8.20357C0.5 11.8286 2.86451 14.9 6.14241 15.9857C6.19397 15.9964 6.23817 16 6.28237 16C6.58806 16 6.70592 15.7821 6.70592 15.5929C6.70592 15.3964 6.69855 14.8821 6.69487 14.1964C6.38549 14.2643 6.10926 14.2929 5.8625 14.2929C4.27511 14.2929 3.91417 13.0964 3.91417 13.0964C3.5385 12.15 2.9971 11.8964 2.9971 11.8964C2.27891 11.4071 2.99342 11.3929 3.04866 11.3929H3.05234C3.88103 11.4643 4.31563 12.2429 4.31563 12.2429C4.72813 12.9429 5.28058 13.1393 5.77411 13.1393C6.16083 13.1393 6.51071 13.0179 6.71696 12.925C6.79063 12.3964 7.00424 12.0357 7.23996 11.8286C5.40949 11.6214 3.48326 10.9179 3.48326 7.775C3.48326 6.87857 3.80368 6.14643 4.33036 5.575C4.24565 5.36786 3.96205 4.53214 4.41138 3.40357C4.41138 3.40357 4.47031 3.38571 4.59554 3.38571C4.89386 3.38571 5.56786 3.49643 6.68013 4.24643C7.3394 4.06429 8.04286 3.975 8.74632 3.97143C9.44609 3.975 10.1532 4.06429 10.8125 4.24643C11.9248 3.49643 12.5988 3.38571 12.8971 3.38571C13.0223 3.38571 13.0813 3.40357 13.0813 3.40357C13.5306 4.53214 13.247 5.36786 13.1623 5.575C13.689 6.15 14.0094 6.88214 14.0094 7.775C14.0094 10.925 12.0795 11.6179 10.2416 11.8214C10.5363 12.075 10.8015 12.575 10.8015 13.3393C10.8015 14.4357 10.7904 15.3214 10.7904 15.5893C10.7904 15.7821 10.9046 16 11.2103 16C11.2545 16 11.306 15.9964 11.3576 15.9857C14.6392 14.9 17 11.825 17 8.20357C17 3.675 13.3059 0 8.75 0Z" fill="#92A0B3"></path></svg>Edit this page</a></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/TongchengOpenSource/ckibana/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Github Issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://tongchengopensource.github.io/ckibana-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>CKibana Documentation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/TongchengOpenSource/ckibana" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 TongchengOpenSource</div></div></div></footer></div>
<script src="/ckibana-docs/assets/js/runtime~main.e0215409.js"></script>
<script src="/ckibana-docs/assets/js/main.e9f90eef.js"></script>
</body>
</html>